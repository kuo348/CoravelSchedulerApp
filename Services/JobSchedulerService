public class JobSchedulerService
{
    private readonly IScheduler _scheduler;
    private readonly AppDbContext _db;

    public JobSchedulerService(IScheduler scheduler, AppDbContext db)
    {
        _scheduler = scheduler;
        _db = db;
    }

    public async Task ScheduleAllJobsAsync()
    {
        var jobs = await _db.ScheduledJobs.Where(j => j.IsActive).ToListAsync();

        foreach (var job in jobs)
        {
            _scheduler.Schedule(() => ExecuteJob(job.JobName))
                      .Cron(job.CronExpression);
        }
    }

    public void ExecuteJob(string jobName)
    {
        Console.WriteLine($"執行任務：{jobName}，時間：{DateTime.Now}");
    }
}
